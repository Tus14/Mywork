# Проект создания нового виджета

## Описание:
 Это виджет, который показывает несколько последних успешных банковских операций клиента. 

## Установка:

1. Клонируйте репозиторий:
```
git clone https://github.com/Tus14/Mywork.git
```
2. Установите зависимости:
```
pip install -r requirements.txt
```
## Использование:

1. Откройте приложение в вашем веб-браузере.
2. Разработанные функции помогут Вам в решении вашей задачи:
- def get_mask_card_number
 """Принимает номер карты и возвращает его маскированную версию."""
- def get_mask_account
"""Принимает номер счёта и возвращает его маскированную версию."""
- def mask_card
"""Маскирует номер карты, оставляя открытыми первые 6 и последние 4 цифры."""
- def mask_account
"""Функция принимает строку, определяет тип (карта или счет) и маскирует номер"""
- def get_date
"""Функция, которая принимает дату в виде строки с лишними элементами
    и возвращает дату в виде строки в нужном формате"""
- def filter_by_state
"""Функция, которая принимает список словарей и опционально значение для ключа
    state (по умолчанию 'EXECUTED')"""
- def sort_by_date
""" Функция сортирует список словарей по дате, используя несколько строк кода."""
- def filter_by_currency
"""Функция фильтрует список операций(транзакций) по заданной валюте
и возвращает итератор"""
- def transaction_descriptions
"""Генератор, который принимает список транзакций и возвращает
описание каждой операции по очереди. Если описание отсутствует, то выводится 'Описание
отсутствует'"""
- def card_number_generator
"""Генератор, использующий map для форматирования диапазона чисел."""
- def log
"""который будет автоматически логировать начало и конец выполнения функции, а также ее результаты
или возникшие ошибки"""
- def convert_transaction_to_rub
Конвертирует сумму транзакции в рубли.
- def load_transactions
Загружает данные о финансовых транзакциях из JSON-файла

# Тестирование модулей банковского приложения

## Характеристика тестируемых функций:

- **masks.py** - функции принимают номер карты или счета и маскируют их
- **widget** - функции форматирования и маскирования
- **processing** - функции обработки данных
- **generators** - функция и генераторы для обработки большого количества данных
- **utils.py** - функция загружает данные о финансовых транзакциях из JSON-файла
- **external_api.py** - Конвертирует сумму транзакции в рубли


### Функции в пакете masks.py и тесты к ним
**def get_mask_card_number** """Принимает номер карты и возвращает его маскированную версию."""

- **тесты с использованием фикстур**: 
1. Фикстура, предоставляющая стандартный 16-значный номер карты.
2. Фикстура, предоставляющая номер карты с пробелами.
- **тесты с использованием параметризации**:
1. Проверяет, что функция возвращает корректно отформатированную маску
    для разных типов и длин входных данных.
2. Проверяет, что функция обрабатывает некорректные входные строки,
    где отсутствует номер карты или он нестандартный.В текущей реализации
    функция просто возвращает исходное значение.
- **тесты с использованием assert**:
1. Тестирование корректного маскирования номера карты в формате строки.
2. Тестирование корректного маскирования номера карты в формате целого числа.

**def get_mask_account** """Принимает номер счёта и возвращает его маскированную версию."""

- **тесты с использованием фикстур**:
1. Фикстура, предоставляющая валидный номер счета.
2. Фикстура для короткого номера (пограничный случай).
- **тесты с использованием параметризации**:
1. Параметризованный тест для проверки корректного маскирования.
- **тесты с использованием assert**:
1. Тест, использующий фикстуру для проверки корректного маскирования.


### Функции в пакете processing.py и тесты к ним
**def filter_by_state** """Функция, которая принимает список словарей и опционально значение для ключа
    state (по умолчанию 'EXECUTED')"""

- **тесты с использованием фикстур**:
1. Фикстура, предоставляющая тестовый набор данных
- **тесты с использованием параметризации**:
1. Проверка корректности фильтрации для существующих статусов с использованием параметризации
- **тесты с использованием assert**:
1. Тестирование случая, когда ни один словарь не соответствует заданному статусу.
2. Тестирование передачи пустого списка.

**def sort_by_date** Функция сортирует список словарей по дате, используя несколько строк кода.

- **тесты с использованием фикстур**:
1. Фикстура, предоставляющая тестовый набор операций с разными датами.
2. Фикстура с операциями, одна из которых не имеет ключа 'date'
- **тесты с использованием параметризации**:
1. Тестирование сортировки списка словарей по датам в порядке убывания и возрастания
    с использованием параметризации.
- **тесты с использованием assert**:
1. Тестирование обработки пустого списка (должно возвращать пустой список без ошибок)
2. Тестирование обработки отсутствия ключа 'date'.
    Элементы без даты должны попасть в конец при убывающей сортировке,
    так как str(item_dict.get("date", "")) вернет пустую строку "".


### Функции в пакете widget.py и тесты к ним
**def mask_account_card** """Функция принимает строку, определяет тип (карта или счет) и маскирует номер"""
### использование дополнительных функций
**def mask_card** """Маскирует номер карты, оставляя открытыми первые 6 и последние 4 цифры."""
**def mask_account** """Маскирует номер счета, оставляя открытыми только последние 4 цифры."""

- **тесты с использованием фикстур**:
1. Полный валидный номер карты для использования в тестах.
2. Полный валидный номер счета для использования в тестах.
- **тесты с использованием параметризации**:
1. Проверка универсальности функции на различных валидных входных данных.
2. Проверка устойчивости функции к некорректным входным данным.
- **тесты с использованием assert**:
1. Использование фикстур как аргумента

**def get_date** """Функция, которая принимает дату в виде строки с лишними элементами
    и возвращает дату в виде строки в нужном формате"""

- **тесты с использованием фикстур**:
1. Фикстура, предоставляющая стандартную строку даты и времени в формате ISO 8601
- **тесты с использованием параметризации**:
1. Тестирование корректного преобразования различных валидных строк дат.


### Функции в пакете generators.py и тесты к ним
**def filter_by_currency**"""Функция фильтрует список операций(транзакций) по заданной 
валюте и возвращает итератор"""

- **тесты с использованием фикстур**:
1. Фикстура, которая Проверяет, что функция корректно фильтрует транзакции 
по заданной валюте (USD)
2. Проверяет, что функция правильно обрабатывает случаи, когда транзакции
в заданной валюте (EUR) отсутствуют
3. Убеждается, что функция не завершается ошибкой при обработке пустого
списка транзакций
4. Убеждается, что генератор корректно обрабатывает список, где нужная валюта
    отсутствует (например, ищем JPY, но есть только USD и RUB).
5. Проверяет, что функция возвращает именно итератор (генератор)
    и работает лениво (lazy evaluation).
- **тесты с использованием параметризации**:
1. Универсальный тест, который проверяет фильтрацию для разных валют
    и ожидаемых результатов.

**def transaction_descriptions**Генератор, который принимает список транзакций 
и возвращает описание каждой операции по очереди. Если описание отсутствует,
то выводится 'Описание отсутствует
- **тесты с использованием фикстур**:
1. Фикстура, предоставляющая пустой список транзакций
- **тесты с использованием параметризации**:
1. Тестирует функцию transaction_descriptions, используя параметризацию
для разных наборов входных данных (обычный и пустой список)

**def card_number_generator**Генератор, использующий map для форматирования диапазона чисел
для этого введена дополнительная функция **def format_card**Вспомогательная функция для форматирования 
одного целого числа в номер карты
- **тесты с использованием параметризации**:
1. Тестирует генерацию и форматирование номеров карт в различных диапазонах
2. Проверяет, что итератор корректно завершается (вызывает StopIteration)


**Добавлен отчет о покрытии в HTML-формате**

# Добавлен декоратор log
- автоматически логировать начало и конец выполнения функции, а также ее результаты или возникшие ошибки.
## Тестирование декоратора
- def test_log_to_file_success
Проверяет успешное выполнение функции и запись лога в файл
- def test_log_to_console_success
Проверяет вывод лога успешного выполнения функции в консоль
- def test_log_to_console_exception
Проверяет вывод лога ошибки в консоль при возникновении исключения


# Добавлен файл utils.py, 
**def load_transactions** Загружает данные о финансовых транзакциях из JSON-файла
## Тестирование в test_utils.py
- def test_load_transactions_success
Тестирование успешной загрузки корректного JSON-файла
- test_load_transactions_file_not_found
Тестирование обработки исключения FileNotFoundError
- test_load_transactions_empty_file
Тестирование обработки пустого файла
- test_load_transactions_invalid_json
Тестирование обработки некорректного JSON.
- test_load_transactions_not_a_list
Тестирование обработки JSON, который не является списком (например, словарь).

# Добавлен файл external_api.py,
**def convert_transaction_to_rub**
Конвертирует сумму транзакции в рубли.
## Тестирование в test_external_api.py
- test_convert_usd_to_rub
Тест конвертации USD в RUB
-test_convert_eur_to_rub
Тест конвертации EUR в RUB
- test_return_rub_without_conversion
Тест возврата RUB без конвертации.
- test_unsupported_currency
Тест неподдерживаемой валюты
- test_api_error_handling
Тест обработки ошибки API
- test_request_exception_handling
Тест обработки исключения запроса
- test_missing_api_key
Тест отсутствия API ключа

# В корневую папку добавлен operations.json,
-вложенный список

## Документация:

Для получения дополнительной информации обратитесь к [документации](docs/README.md).

## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).